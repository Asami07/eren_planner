<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eren'in Pro Planner'ƒ± v9</title>
    <style>
        :root { --primary: #4a90e2; --secondary: #f39c12; --special: #9b59b6; --routine: #2ecc71; --bg: #f4f7f6; --text: #2c3e50; --success: #2ecc71; --danger: #e74c3c; --undo: #34495e; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { width: 100%; max-width: 1200px; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        
        /* √úst Panel */
        .stats-container { display: flex; flex-direction: column; gap: 10px; margin-bottom: 25px; background: #2c3e50; color: white; padding: 20px; border-radius: 15px; }
        .stats-top { display: flex; justify-content: space-between; align-items: center; }
        .level-badge { background: var(--secondary); padding: 5px 15px; border-radius: 20px; font-weight: bold; }
        .xp-bar-bg { background: rgba(255,255,255,0.1); height: 12px; border-radius: 6px; overflow: hidden; }
        .xp-bar-fill { background: var(--success); height: 100%; width: 0%; transition: 0.5s ease; }

        .action-bar { display: flex; justify-content: space-between; align-items: center; margin-top: 5px; }
        .undo-btn { background: var(--undo); color: white; border: none; padding: 5px 12px; border-radius: 5px; font-size: 0.75rem; cursor: pointer; display: none; }
        .reset-xp-btn { background: var(--danger); color: white; border: none; padding: 5px 10px; border-radius: 5px; font-size: 0.7rem; cursor: pointer; opacity: 0.8; }

        /* Giri≈ü Alanƒ± */
        .input-area { background: #f9f9f9; padding: 20px; border-radius: 10px; margin-bottom: 25px; border: 1px solid #eee; display: flex; flex-direction: column; gap: 10px; }
        .input-row { display: flex; gap: 10px; flex-wrap: wrap; }
        input, select { padding: 12px; border: 1px solid #ddd; border-radius: 8px; }
        input[type="text"] { flex: 2; min-width: 200px; }
        
        .main-btn-group { display: flex; gap: 10px; }
        .add-btn { background: var(--primary); color: white; border: none; border-radius: 8px; padding: 12px 25px; font-weight: bold; cursor: pointer; flex: 2; }
        .sweep-btn { background: #95a5a6; color: white; border: none; border-radius: 8px; padding: 12px 25px; font-weight: bold; cursor: pointer; flex: 1; transition: 0.3s; }
        .sweep-btn:hover { background: #7f8c8d; }

        /* S√ºtunlar */
        .columns { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 15px; }
        .column { background: #fff; padding: 15px; border-radius: 12px; border: 1px solid #eee; display: flex; flex-direction: column; }
        .column h3 { text-align: center; border-bottom: 2px solid #f1f1f1; padding-bottom: 10px; margin-top: 0; }
        .task-list { flex-grow: 1; min-height: 50px; }
        
        .task-item { display: flex; align-items: center; background: #fff; padding: 10px; margin-bottom: 8px; border-radius: 8px; border-left: 5px solid #ddd; box-shadow: 0 2px 5px rgba(0,0,0,0.03); font-size: 0.9rem; }
        .task-item.routine.done-today { background: #eafff0; border-left-color: var(--routine); }
        .task-item.completed { opacity: 0.4; text-decoration: line-through; }

        .routine-btn { background: var(--routine); color: white; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer; font-size: 0.7rem; margin-left: auto; display: flex; flex-direction: column; align-items: center; }
        .col-clear-btn { background: #f8f9fa; color: #6c757d; border: 1px solid #ddd; border-radius: 5px; padding: 5px; font-size: 0.7rem; cursor: pointer; margin-top: 15px; }
        .col-clear-btn:hover { background: #ffeaea; color: var(--danger); border-color: var(--danger); }
        .delete-icon { background: none; color: #e74c3c; border: none; cursor: pointer; font-size: 1.1rem; margin-left: 8px; }
    </style>
</head>
<body>

    <div class="container">
        <div class="stats-container">
            <div class="stats-top">
                <span>‚≠ê Toplam XP: <span id="score">0</span></span>
                <span class="level-badge">Level <span id="level">1</span></span>
            </div>
            <div class="xp-bar-bg"><div id="xpBar" class="xp-bar-fill"></div></div>
            <div class="action-bar">
                <small style="opacity: 0.7;">Sonraki seviye: <span id="nextLevelXp">500</span> XP</small>
                <div style="display: flex; gap: 10px;">
                    <button id="undoBtn" class="undo-btn" onclick="undoLastAction()">‚Ü© Geri Al</button>
                    <button class="reset-xp-btn" onclick="resetOnlyXP()">‚ö† Sadece XP Sƒ±fƒ±rla</button>
                </div>
            </div>
        </div>

        <div class="input-area">
            <div class="input-row">
                <input type="text" id="taskInput" placeholder="G√∂rev veya rutin adƒ±...">
                <select id="taskType" onchange="toggleDatePicker()">
                    <option value="daily">G√ºnl√ºk (10 XP)</option>
                    <option value="weekly">Haftalƒ±k (20 XP)</option>
                    <option value="special">√ñzel G√ºn</option>
                    <option value="routine">Sabit Rutin (15 XP)</option>
                </select>
                <input type="date" id="specialDate" style="display:none;">
            </div>
            <div class="main-btn-group">
                <button class="add-btn" onclick="addTask()">‚ûï Yeni G√∂rev Ekle</button>
                <button class="sweep-btn" onclick="clearCompleted()">üßπ Tamamlananlarƒ± S√ºp√ºr</button>
            </div>
        </div>

        <div class="columns">
            <div class="column"><h3 style="color:var(--routine)">Rutinler</h3><div id="routineTasks" class="task-list"></div><button class="col-clear-btn" onclick="clearCategory('routine')">üóë Rutinleri Sil</button></div>
            <div class="column"><h3 style="color:var(--primary)">G√ºnl√ºk</h3><div id="dailyTasks" class="task-list"></div><button class="col-clear-btn" onclick="clearCategory('daily')">üóë G√ºnl√ºkleri Sil</button></div>
            <div class="column"><h3 style="color:var(--secondary)">Haftalƒ±k</h3><div id="weeklyTasks" class="task-list"></div><button class="col-clear-btn" onclick="clearCategory('weekly')">üóë Haftalƒ±klarƒ± Sil</button></div>
            <div class="column"><h3 style="color:var(--special)">√ñzel</h3><div id="specialTasks" class="task-list"></div><button class="col-clear-btn" onclick="clearCategory('special')">üóë √ñzelleri Sil</button></div>
        </div>
    </div>

    <script>
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        let score = parseInt(localStorage.getItem('score')) || 0;
        let lastAction = null;
        const XP_PER_LEVEL = 500;

        function toggleDatePicker() {
            const type = document.getElementById('taskType').value;
            document.getElementById('specialDate').style.display = (type === 'special') ? 'block' : 'none';
        }

        function updateUI() {
            const divs = { daily: document.getElementById('dailyTasks'), weekly: document.getElementById('weeklyTasks'), special: document.getElementById('specialTasks'), routine: document.getElementById('routineTasks') };
            Object.values(divs).forEach(d => d.innerHTML = '');

            const currentLevel = Math.floor(score / XP_PER_LEVEL) + 1;
            const currentLevelXp = score % XP_PER_LEVEL;
            document.getElementById('score').innerText = score;
            document.getElementById('level').innerText = currentLevel;
            document.getElementById('xpBar').style.width = (currentLevelXp / XP_PER_LEVEL * 100) + "%";
            document.getElementById('nextLevelXp').innerText = XP_PER_LEVEL - currentLevelXp;
            document.getElementById('undoBtn').style.display = lastAction ? 'block' : 'none';

            tasks.forEach((task, index) => {
                const el = document.createElement('div');
                const isRoutineDone = task.type === 'routine' && task.count > 0;
                el.className = `task-item ${task.type} ${task.completed ? 'completed' : ''} ${isRoutineDone ? 'done-today' : ''}`;
                
                if (task.type === 'routine') {
                    el.innerHTML = `<span style="flex:1">üîÑ ${task.text}</span><button class="routine-btn" onclick="completeRoutine(${index})"><span>TAMAMLA</span><span style="font-size:0.6rem">Bug√ºn: ${task.count || 0}</span></button><button class="delete-icon" onclick="deleteTask(${index})">√ó</button>`;
                } else {
                    const dateTag = task.date ? `<span style="font-size:0.7rem; background:#eee; padding:2px; border-radius:3px; margin-right:5px;">${task.date.split('-').reverse().join('/')}</span>` : '';
                    el.innerHTML = `<input type="checkbox" ${task.completed ? 'checked' : ''} onchange="toggleTask(${index})">${dateTag}<span style="flex:1">${task.text}</span><button class="delete-icon" onclick="deleteTask(${index})">√ó</button>`;
                }
                divs[task.type].appendChild(el);
            });

            localStorage.setItem('tasks', JSON.stringify(tasks));
            localStorage.setItem('score', score);
        }

        function addTask() {
            const input = document.getElementById('taskInput');
            const type = document.getElementById('taskType').value;
            const date = document.getElementById('specialDate').value;
            if (!input.value.trim()) return;
            tasks.push({ text: input.value, type: type, date: type === 'special' ? date : null, completed: false, count: type === 'routine' ? 0 : null });
            input.value = ''; updateUI();
        }

        function toggleTask(index) {
            const points = tasks[index].type === 'weekly' ? 20 : 10;
            tasks[index].completed = !tasks[index].completed;
            score += tasks[index].completed ? points : -points;
            lastAction = { type: 'toggle', index: index, points: points };
            updateUI();
        }

        function completeRoutine(index) {
            score += 15; tasks[index].count++;
            lastAction = { type: 'routine', index: index, points: 15 };
            updateUI();
        }

        function undoLastAction() {
            if (!lastAction) return;
            if (lastAction.type === 'toggle') {
                score += tasks[lastAction.index].completed ? -lastAction.points : lastAction.points;
                tasks[lastAction.index].completed = !tasks[lastAction.index].completed;
            } else {
                score -= 15; tasks[lastAction.index].count--;
            }
            lastAction = null; updateUI();
        }

        function clearCompleted() {
            if (confirm("Tamamlanmƒ±≈ü t√ºm g√∂revler silinecek. Emin misiniz?")) {
                tasks = tasks.filter(t => !t.completed || t.type === 'routine');
                updateUI();
            }
        }

        function resetOnlyXP() {
            if (confirm("‚ö† G√∂revleriniz kalacak, sadece XP ve Seviyeniz sƒ±fƒ±rlanacak. Emin misiniz?")) {
                score = 0; lastAction = null; updateUI();
            }
        }

        function clearCategory(category) {
            if (confirm(`Bu s√ºtundaki T√úM veriler silinecek. Emin misiniz?`)) {
                tasks = tasks.filter(t => t.type !== category);
                updateUI();
            }
        }

        function deleteTask(index) {
            if (tasks[index].completed && tasks[index].type !== 'routine') {
                score -= (tasks[index].type === 'weekly' ? 20 : 10);
            }
            tasks.splice(index, 1); updateUI();
        }

        updateUI();
    </script>
</body>
</html>